The logic is confused, and the ending is a bad one.